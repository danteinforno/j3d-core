<?xml version="1.0"?>

<!--
/*
 * $RCSfile$
 *
 * Copyright (c) 2004 Sun Microsystems, Inc. All rights reserved.
 *
 * Use is subject to license terms.
 *
 * $Revision$
 * $Date$
 * $State$
 */
 -->

<!-- Ant file for building native utilities files for Solaris -->
<project name="Java 3D" default="compile">

  <target name="compile">

    <echo message="Executing 32 bit native utilities build [${bldType}]"/>

    <!-- Create the build directories sparc -->
    <mkdir dir="${build}/${platform}/${bldType}/native/share/objs"/>
    <mkdir dir="${build}/${platform}/${bldType}/lib/sparc"/>

    <!-- Compile the c source files-->
    <exec dir="${build}/${platform}/${bldType}/native/share/objs" executable="gcc">
	<arg line="-m32 -mcpu=v9 -mtune=v9 -I/include -I${java.home}/../include -I${java.home}/../include/solaris -I/usr/openwin/include -I${javahUtilsTarget} -${bldFlag} -DSOLARIS -c ${core_utils_src}/native/share/J3DTimer.c"/>
    </exec>

    <!-- Create the library file-->
    <exec dir="${build}/${platform}/${bldType}/native/share/objs" executable="ld">
	<arg line="J3DTimer.o -G -z lazyload -lposix4 -lc -o libj3dutils.so"/>
    </exec>

    <!-- Copy the copyright library file -->
    <copy file="${build}/${platform}/${bldType}/native/share/objs/libj3dutils.so" 
	 todir="${build}/${platform}/${bldType}/lib/sparc"/>

<!-- ********************************************************************** -->
    <echo message="Executing 64 bit native utilities build [${bldType}]"/>

    <!-- Create the build directories sparcv9 -->
    <mkdir dir="${build}/${platform}/${bldType}/native/share/objs/sparcv9"/>
    <mkdir dir="${build}/${platform}/${bldType}/lib/sparcv9"/>

    <!-- Compile the c source files-->
    <exec dir="${build}/${platform}/${bldType}/native/share/objs/sparcv9" executable="gcc">
	<arg line="-m64 -mcpu=v9 -mtune=v9 -I/include -I${java.home}/../include -I${java.home}/../include/solaris -I/usr/openwin/include -I${javahUtilsTarget} -${bldFlag} -DSOLARIS -c ${core_utils_src}/native/share/J3DTimer.c"/>
    </exec>

    <!-- Create the library file-->
    <exec dir="${build}/${platform}/${bldType}/native/share/objs/sparcv9" executable="ld">
	<arg line="J3DTimer.o -G -z lazyload -lposix4 -lc -o libj3dutils.so"/>
    </exec>

    <!-- Copy the copyright library file -->
    <copy file="${build}/${platform}/${bldType}/native/share/objs/sparcv9/libj3dutils.so" 
	 todir="${build}/${platform}/${bldType}/lib/sparcv9"/>

  </target>

  <target name="dist">
    <!-- Create the distribution directory -->
    <mkdir dir="${dist}/${platform}/lib/sparc"/>
    <mkdir dir="${dist}/${platform}/lib/sparcv9"/>

    <!-- Copy the library files -->
    <copy file="${build}/${platform}/opt/lib/sparc/libj3dutils.so"
	 todir="${dist}/${platform}/lib/sparc"/>

    <copy file="${build}/${platform}/opt/lib/sparcv9/libj3dutils.so"
	 todir="${dist}/${platform}/lib/sparcv9"/>
  </target>


</project>
